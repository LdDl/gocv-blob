package blob

import (
	"image"
	"testing"
)

func TestArrayTracker(t *testing.T) {
	maxPointsInTrack := 150
	classID := 1
	className := "just_an_object"
	allblobies := NewBlobiesDefaults()

	rectHalfHeight := 30
	rectHalfWidth := 75

	correctOverallBlobies := 3
	for i := range objectOne {
		centerOne := objectOne[i]
		centerTwo := objectTwo[i]
		centerThree := objectThree[i]

		rectOne := image.Rect(centerOne[0]-rectHalfWidth, centerOne[1]-rectHalfHeight, centerOne[0]+rectHalfWidth, centerOne[1]+rectHalfHeight)
		rectTwo := image.Rect(centerTwo[0]-rectHalfWidth, centerTwo[1]-rectHalfHeight, centerTwo[0]+rectHalfWidth, centerTwo[1]+rectHalfHeight)
		rectThree := image.Rect(centerThree[0]-rectHalfWidth, centerThree[1]-rectHalfHeight, centerThree[0]+rectHalfWidth, centerThree[1]+rectHalfHeight)

		blobOne := NewSimpleBlobie(rectOne, maxPointsInTrack, classID, className)
		blobTwo := NewSimpleBlobie(rectTwo, maxPointsInTrack, classID, className)
		blobThree := NewSimpleBlobie(rectThree, maxPointsInTrack, classID, className)
		currentFrameBlobies := []Blobie{blobOne, blobTwo, blobThree}
		allblobies.MatchToExisting(currentFrameBlobies)

		if correctOverallBlobies != len(allblobies.Objects) {
			t.Errorf("Total number of blobs on frame %d should be %d, bot got %d", i, correctOverallBlobies, len(allblobies.Objects))
		}
	}
}

var (
	objectOne = [][]int{
		[]int{311, 5},
		[]int{312, 6},
		[]int{313, 8},
		[]int{311, 10},
		[]int{311, 11},
		[]int{312, 12},
		[]int{312, 12},
		[]int{313, 13},
		[]int{312, 16},
		[]int{312, 16},
		[]int{312, 18},
		[]int{312, 18},
		[]int{312, 19},
		[]int{312, 19},
		[]int{312, 20},
		[]int{312, 20},
		[]int{312, 22},
		[]int{312, 22},
		[]int{311, 23},
		[]int{311, 23},
		[]int{311, 24},
		[]int{311, 24},
		[]int{311, 28},
		[]int{310, 30},
		[]int{311, 32},
		[]int{311, 35},
		[]int{311, 39},
		[]int{310, 42},
		[]int{310, 44},
		[]int{308, 46},
		[]int{307, 56},
		[]int{308, 58},
		[]int{308, 70},
		[]int{308, 60},
		[]int{307, 52},
		[]int{307, 64},
		[]int{307, 51},
		[]int{308, 70},
		[]int{307, 70},
		[]int{307, 70},
		[]int{307, 66},
		[]int{307, 83},
		[]int{307, 80},
		[]int{308, 85},
		[]int{307, 80},
		[]int{309, 98},
		[]int{306, 79},
		[]int{307, 98},
		[]int{306, 61},
		[]int{307, 94},
		[]int{308, 101},
		[]int{306, 94},
		[]int{306, 104},
		[]int{306, 94},
		[]int{305, 107},
		[]int{307, 112},
		[]int{307, 108},
		[]int{307, 108},
		[]int{306, 109},
		[]int{306, 109},
		[]int{306, 121},
		[]int{307, 108},
		[]int{307, 108},
		[]int{308, 120},
		[]int{307, 122},
		[]int{307, 122},
		[]int{308, 128},
		[]int{307, 130},
		[]int{306, 122},
		[]int{308, 140},
		[]int{309, 122},
		[]int{309, 122},
		[]int{309, 140},
		[]int{309, 122},
		[]int{308, 134},
		[]int{309, 141},
		[]int{309, 136},
		[]int{309, 136},
		[]int{308, 154},
		[]int{311, 155},
		[]int{311, 155},
		[]int{307, 150},
		[]int{311, 161},
		[]int{307, 162},
		[]int{313, 169},
		[]int{311, 171},
		[]int{307, 181},
		[]int{311, 175},
		[]int{311, 175},
		[]int{306, 163},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
		[]int{312, 178},
	}

	objectTwo = [][]int{
		[]int{311 + 85, 5},
		[]int{312 + 85, 6},
		[]int{313 + 85, 8},
		[]int{311 + 85, 10},
		[]int{311 + 85, 11},
		[]int{312 + 85, 12},
		[]int{312 + 85, 12},
		[]int{313 + 85, 13},
		[]int{312 + 85, 16},
		[]int{312 + 85, 16},
		[]int{312 + 85, 18},
		[]int{312 + 85, 18},
		[]int{312 + 85, 19},
		[]int{312 + 85, 19},
		[]int{312 + 85, 20},
		[]int{312 + 85, 20},
		[]int{312 + 85, 22},
		[]int{312 + 85, 22},
		[]int{311 + 85, 23},
		[]int{311 + 85, 23},
		[]int{311 + 85, 24},
		[]int{311 + 85, 24},
		[]int{311 + 85, 28},
		[]int{310 + 85, 30},
		[]int{311 + 85, 32},
		[]int{311 + 85, 35},
		[]int{311 + 85, 39},
		[]int{310 + 85, 42},
		[]int{310 + 85, 44},
		[]int{308 + 85, 46},
		[]int{307 + 85, 56},
		[]int{308 + 85, 58},
		[]int{308 + 85, 70},
		[]int{308 + 85, 60},
		[]int{307 + 85, 52},
		[]int{307 + 85, 64},
		[]int{307 + 85, 51},
		[]int{308 + 85, 70},
		[]int{307 + 85, 70},
		[]int{307 + 85, 70},
		[]int{307 + 85, 66},
		[]int{307 + 85, 83},
		[]int{307 + 85, 80},
		[]int{308 + 85, 85},
		[]int{307 + 85, 80},
		[]int{309 + 85, 98},
		[]int{306 + 85, 79},
		[]int{307 + 85, 98},
		[]int{306 + 85, 61},
		[]int{307 + 85, 94},
		[]int{308 + 85, 101},
		[]int{306 + 85, 94},
		[]int{306 + 85, 104},
		[]int{306 + 85, 94},
		[]int{305 + 85, 107},
		[]int{307 + 85, 112},
		[]int{307 + 85, 108},
		[]int{307 + 85, 108},
		[]int{306 + 85, 109},
		[]int{306 + 85, 109},
		[]int{306 + 85, 121},
		[]int{307 + 85, 108},
		[]int{307 + 85, 108},
		[]int{308 + 85, 120},
		[]int{307 + 85, 122},
		[]int{307 + 85, 122},
		[]int{308 + 85, 128},
		[]int{307 + 85, 130},
		[]int{306 + 85, 122},
		[]int{308 + 85, 140},
		[]int{309 + 85, 122},
		[]int{309 + 85, 122},
		[]int{309 + 85, 140},
		[]int{309 + 85, 122},
		[]int{308 + 85, 134},
		[]int{309 + 85, 141},
		[]int{309 + 85, 136},
		[]int{309 + 85, 136},
		[]int{308 + 85, 154},
		[]int{311 + 85, 155},
		[]int{311 + 85, 155},
		[]int{307 + 85, 150},
		[]int{311 + 85, 161},
		[]int{307 + 85, 162},
		[]int{313 + 85, 169},
		[]int{311 + 85, 171},
		[]int{307 + 85, 181},
		[]int{311 + 85, 175},
		[]int{311 + 85, 175},
		[]int{306 + 85, 163},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
		[]int{312 + 85, 178},
	}

	objectThree = [][]int{
		[]int{311 - 85, 5},
		[]int{312 - 85, 6},
		[]int{313 - 85, 8},
		[]int{311 - 85, 10},
		[]int{311 - 85, 11},
		[]int{312 - 85, 12},
		[]int{312 - 85, 12},
		[]int{313 - 85, 13},
		[]int{312 - 85, 16},
		[]int{312 - 85, 16},
		[]int{312 - 85, 18},
		[]int{312 - 85, 18},
		[]int{312 - 85, 19},
		[]int{312 - 85, 19},
		[]int{312 - 85, 20},
		[]int{312 - 85, 20},
		[]int{312 - 85, 22},
		[]int{312 - 85, 22},
		[]int{311 - 85, 23},
		[]int{311 - 85, 23},
		[]int{311 - 85, 24},
		[]int{311 - 85, 24},
		[]int{311 - 85, 28},
		[]int{310 - 85, 30},
		[]int{311 - 85, 32},
		[]int{311 - 85, 35},
		[]int{311 - 85, 39},
		[]int{310 - 85, 42},
		[]int{310 - 85, 44},
		[]int{308 - 85, 46},
		[]int{307 - 85, 56},
		[]int{308 - 85, 58},
		[]int{308 - 85, 70},
		[]int{308 - 85, 60},
		[]int{307 - 85, 52},
		[]int{307 - 85, 64},
		[]int{307 - 85, 51},
		[]int{308 - 85, 70},
		[]int{307 - 85, 70},
		[]int{307 - 85, 70},
		[]int{307 - 85, 66},
		[]int{307 - 85, 83},
		[]int{307 - 85, 80},
		[]int{308 - 85, 85},
		[]int{307 - 85, 80},
		[]int{309 - 85, 98},
		[]int{306 - 85, 79},
		[]int{307 - 85, 98},
		[]int{306 - 85, 61},
		[]int{307 - 85, 94},
		[]int{308 - 85, 101},
		[]int{306 - 85, 94},
		[]int{306 - 85, 104},
		[]int{306 - 85, 94},
		[]int{305 - 85, 107},
		[]int{307 - 85, 112},
		[]int{307 - 85, 108},
		[]int{307 - 85, 108},
		[]int{306 - 85, 109},
		[]int{306 - 85, 109},
		[]int{306 - 85, 121},
		[]int{307 - 85, 108},
		[]int{307 - 85, 108},
		[]int{308 - 85, 120},
		[]int{307 - 85, 122},
		[]int{307 - 85, 122},
		[]int{308 - 85, 128},
		[]int{307 - 85, 130},
		[]int{306 - 85, 122},
		[]int{308 - 85, 140},
		[]int{309 - 85, 122},
		[]int{309 - 85, 122},
		[]int{309 - 85, 140},
		[]int{309 - 85, 122},
		[]int{308 - 85, 134},
		[]int{309 - 85, 141},
		[]int{309 - 85, 136},
		[]int{309 - 85, 136},
		[]int{308 - 85, 154},
		[]int{311 - 85, 155},
		[]int{311 - 85, 155},
		[]int{307 - 85, 150},
		[]int{311 - 85, 161},
		[]int{307 - 85, 162},
		[]int{313 - 85, 169},
		[]int{311 - 85, 171},
		[]int{307 - 85, 181},
		[]int{311 - 85, 175},
		[]int{311 - 85, 175},
		[]int{306 - 85, 163},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
		[]int{312 - 85, 178},
	}
)
